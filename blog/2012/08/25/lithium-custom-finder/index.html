
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->

<head>


<meta charset="utf-8">
<meta http-equiv="cleartype" content="on">

<title>Lithium Custom Finder - #morcmarc</title>
<meta name="author" content="Marcell Jusztin">




<meta name="description" content="A tech blog by Marcell Jusztin. Updates occaisonally with tips, tricks, and hacks that have helped me out.">

<meta name="keywords" content="li3 php ">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Twitter Cards -->

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/images/abstract-6.jpg"
  
  <meta name="twitter:title" content="Lithium custom finder">
  <meta name="twitter:description" content="A tech blog by Marcell Jusztin. Updates occaisonally with tips, tricks, and hacks that have helped me out.">
  <meta name="twitter:creator" content="@marcelljusztin">


<!-- Open Graph -->
<meta property="og:local" content="en_US">
<meta property="og:type" content="article">
<meta property="og:url" content="http://morcmarc.github.io/blog/blog/2012/08/25/lithium-custom-finder">
<meta property="og:title" content="Lithium custom finder">
<meta property="og:description" content="A tech blog by Marcell Jusztin. Updates occaisonally with tips, tricks, and hacks that have helped me out.">

  <meta property="og:image" content="/images/abstract-6.jpg">

<meta property="og:site_name" content="#morcmarc">

<link rel="canonical" href="http://morcmarc.github.io/blog/blog/2012/08/25/lithium-custom-finder">
<link href="/favicon.png" rel="icon">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
<link href="/atom.xml" rel="alternate" title="#morcmarc" type="application/atom+xml">

<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
<script>Modernizr || document.write('<script src="/javascripts/vendor/modernizr-2.6.2.custom.min.js"><\/script>') </script>



<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>

<body id="post" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/avatar_mj.jpg" alt="Marcell Jusztin photo" class="author-photo">
					<h4>Marcell Jusztin</h4>
					<p>Hello world</p>
				</li>
				
				<li>
					<a href="http://twitter.com/marcelljusztin"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="http://plus.google.com/104798262879041139473"><i class="fa fa-google-plus"></i> Google+</a>
				</li>
				<li>
					<a href="http://github.com/morcmarc"><i class="fa fa-github"></i> GitHub</a>
				</li>
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="/projects/">Projects</a>
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="/posts/">All Posts</a></li>
				<li><a href="/categories/">All Categories</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->



<div class="entry-header">
  
  <div class="entry-image">
    <img src="/images/abstract-6.jpg" alt="Lithium custom finder">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->


<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="/blog/2012/08/25/lithium-custom-finder/" rel="bookmark" title="Lithium custom finder">Lithium custom finder</a></h1>
        
        <h2>August 25, 2012</h2>
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>Finders in Lithium provides you with the option to define easily accessible custom queries for your Model following the principles of DRY and MVC. Thanks to Lithium’s Aspect Oriented filter system you can achieve a Ruby-like pattern with just a few short lines.</p>

<!--more-->

<p>First you need to tell your Model that you would like to use finders. Drop the following code into your model under <code>app\models\</code>:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Initialize Model - app\models\SomeModel.php </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class="line"><span class="k">namespace</span> <span class="nx">app\models</span><span class="p">;</span>
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">SomeModel</span> <span class="k">extends</span> <span class="nx">\lithium\data\Model</span> <span class="p">{</span>
</span><span class="line">	<span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">__init</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">    	<span class="k">parent</span><span class="o">::</span><span class="na">__init</span><span class="p">();</span>
</span><span class="line">    	<span class="c1">// Your finders go here</span>
</span><span class="line">	<span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Next you can start implementing your custom finders inside the <code>__init()</code> method.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Extend basic finder with custom method - app\models\SomeModel.php </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class="line"><span class="o">...</span>
</span><span class="line"><span class="k">static</span><span class="o">::</span><span class="na">finder</span><span class="p">(</span><span class="s1">&#39;myFinder&#39;</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$self</span><span class="p">,</span> <span class="nv">$params</span><span class="p">,</span> <span class="nv">$chain</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="c1">// Put your query paramaters in the $params[&#39;options&#39;] array. </span>
</span><span class="line">  <span class="c1">// You can use any of the parameters that you would use in an ordinary find method.</span>
</span><span class="line">  <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;options&#39;</span><span class="p">][</span><span class="s1">&#39;fields&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span> <span class="p">);</span>
</span><span class="line">  <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;options&#39;</span><span class="p">][</span><span class="s1">&#39;limit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">  <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;options&#39;</span><span class="p">][</span><span class="s1">&#39;with&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;ModelA&#39;</span><span class="p">,</span> <span class="s1">&#39;ModelB&#39;</span> <span class="p">);</span>
</span><span class="line">  <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;options&#39;</span><span class="p">][</span><span class="s1">&#39;conditions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span><span class="line">	 <span class="s1">&#39;name&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;something&#39;</span><span class="p">,</span>
</span><span class="line">	 <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;This is a Title&#39;</span>
</span><span class="line">   <span class="p">);</span>
</span><span class="line">  <span class="c1">// Pass along the query and retrieve the data object</span>
</span><span class="line">  <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$chain</span><span class="o">-&gt;</span><span class="na">next</span><span class="p">(</span><span class="nv">$self</span><span class="p">,</span> <span class="nv">$params</span><span class="p">,</span> <span class="nv">$chain</span><span class="p">);</span>
</span><span class="line">  <span class="c1">// Return the data object if not null</span>
</span><span class="line">  <span class="k">return</span> <span class="nv">$data</span> <span class="o">?:</span> <span class="k">null</span><span class="p">;</span>
</span><span class="line"><span class="p">});</span>
</span><span class="line"><span class="o">...</span>
</span><span class="line"><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>That’s it basically, you can start using your new finder like so:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class="line">	<span class="nx">SomeModel</span><span class="o">::</span><span class="na">myFinder</span><span class="p">(</span> <span class="p">);</span>
</span><span class="line"><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>In case you have to pass a variable to your finder method you can re-use the default <code>id</code> parameter. For example you would like to find a user by username:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class="line">	<span class="nx">Users</span><span class="o">::</span><span class="na">findByUsername</span><span class="p">(</span> <span class="s1">&#39;admin&#39;</span> <span class="p">);</span>
</span><span class="line"><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>This will pass the ‘admin’ string as an <code>'id' =&gt; 'admin'</code> condition parameter which you can then re-assign to the proper field:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>Re-using ID parameter - app\models\Users.php </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="php"><span class="line"><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class="line"><span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;options&#39;</span><span class="p">][</span><span class="s1">&#39;conditions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span><span class="line">	<span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="nv">$params</span><span class="p">[</span><span class="s1">&#39;options&#39;</span><span class="p">][</span><span class="s1">&#39;conditions&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>
</span><span class="line"><span class="p">);</span>
</span><span class="line"><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h2 id="resources">Resources</h2>
<p>You can find more info on <a href="http://nitschinger.at/Custom-Finders-with-Lithium">Michael Nitschinger’s Blog</a> or in the <a href="http://lithify.me/docs/manual/working-with-data/using-models.wiki">Lithium “documentation”</a>.</p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="/categories/#li3" title="Pages tagged li3" class="tag">li3</a><a href="/categories/#php" title="Pages tagged php" class="tag">php</a></span>
        <span><a href="/blog/2012/08/25/lithium-custom-finder/" rel="bookmark" title="Lithium custom finder">Lithium custom finder</a> was published on <span class="entry-date date published updated"><time datetime="2012-08-25T15:36:00+01:00">August 25, 2012</time></span></span>
        
        <span class="author vcard"><span class="fn"><a href="" title="About Marcell Jusztin">Marcell Jusztin</a></span></span>
        
      </footer>
    </div><!-- /.entry-content -->
    
      <div class="read-more">
        
          <div class="read-more-header">
            <a href="/blog/2012/08/27/routing-by-query-parameter-in-lithium/" class="btn">Read More</a>
          </div><!-- /.read-more-header -->
          <div class="read-more-content">
            <h3><a href="/blog/2012/08/27/routing-by-query-parameter-in-lithium/" title="Routing by Query Parameter in Lithium">Routing by Query Parameter in Lithium</a></h3>
            <p>The following routing pattern can be used to map SOAP like web service requests where you have one API endpoint and method calls are passed &hellip;&hellip; <a href="/blog/2012/08/27/routing-by-query-parameter-in-lithium/"> Continue reading</a></p>
          </div><!-- /.read-more-content -->
        
        <div class="read-more-list">
          
            <div class="list-item">
              <h4><a href="/blog/2012/08/27/lithium-quick-tip-for-queries-with-join/" title="Lithium Quick Tip for Queries with Join">Lithium Quick Tip for Queries with Join</a></h4>
              <span>Published on August 27, 2012</span>
            </div><!-- /.list-item -->
          
            <div class="list-item">
              <h4><a href="/blog/2012/05/07/reboot/" title="Reboot... Hello Octopress">Reboot&#8230; Hello Octopress</a></h4>
              <span>Published on May 07, 2012</span>
            </div><!-- /.list-item -->
          
        </div><!-- /.read-more-list -->
      </div><!-- /.read-more -->
    
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2015 Marcell Jusztin. Powered by <a href="http://octopress.org">Octopress</a> using the <a href="https://github.com/Z1MM32M4N/hpstr-theme/">HPSTR Theme for Octopress</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->


	        
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/javascripts/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/javascripts/octopress.js" type="text/javascript"></script>
<script src="/javascripts/scripts.min.js"></script>

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34869123-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>




<script type="text/javascript">
      var disqus_shortname = 'morcmarc';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://morcmarc.github.io/blog/blog/2012/08/25/lithium-custom-finder/';
        var disqus_url = 'http://morcmarc.github.io/blog/blog/2012/08/25/lithium-custom-finder/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	        

</body>
</html>
